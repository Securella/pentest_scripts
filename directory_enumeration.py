import os
import sys
import requests


def enumerate_directories(base_url, directory_list):
    valid_directories_found = False  # Flag to track if any valid directories found

    for directory in directory_list:
        # Construct the directory URL
        dir_url = f"{base_url}/{directory}/"

        # Send a GET request to the directory URL
        response = requests.get(dir_url)

        # Check the response status code
        if response.status_code == 200:
            print("Valid directory:", dir_url)
            valid_directories_found = True  # Set flag to True if a valid directory is found

    if not valid_directories_found:
        print("Sorry, no valid directories found :(")


def main():
    # Check if the correct number of arguments provided
    if len(sys.argv) != 3:
        print("Usage: python3 directory_enumeration.py <base_url> <path_to_wordlist>")
        return

    # target website URL
    base_url = sys.argv[1]

    # Ensure URL includes http:// or https://
    if not base_url.startswith("http://") and not base_url.startswith("https://"):
        print("Error: Base URL must include the scheme (http:// or https://)")
        return

    # path to the wordlist file
    wordlist_file = sys.argv[2]

    # Check if the wordlist file exists
    if not os.path.isfile(wordlist_file):
        print("Error: Wordlist file not found.")
        return

    # Read the wordlist file
    with open(wordlist_file) as file:
        directory_list = file.read().splitlines()

    # Perform directory enumeration
    enumerate_directories(base_url, directory_list)


if __name__ == "__main__":
    main()
