# Modified base from tryhackme.com with the help of:
# source: https://tryhackme.com/room/pythonforcybersecurity

import sys
import hashlib
import pyfiglet


def crack_hash(wordlist_location, hash_input):
    ascii_banner = pyfiglet.figlet_format("Oona's\nHASH CRACKER for MD5")
    print(ascii_banner)

    try:
        with open(wordlist_location, 'r') as file:
            for line in file:
                line = line.strip()
                hash_ob = hashlib.md5(line.encode()).hexdigest()
                if hash_ob == hash_input:
                    print('Found cleartext password:', line)
                    return
            print('Password not found in the wordlist.')
    except FileNotFoundError:
        print("Error: Wordlist file not found.")


if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: python3 script.py <wordlist_file> <hash_to_crack> \n OR python script.py <wordlist_file> <hash_to_crack>")
        sys.exit(1)

    wordlist_location = sys.argv[1]
    hash_input = sys.argv[2]
    crack_hash(wordlist_location, hash_input)
