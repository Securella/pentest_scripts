# Modified base from tryhackme.com with the help of:
# source: https://tryhackme.com/room/pythonforcybersecurity

import sys
import hashlib
import pyfiglet


def crack_hash(wordlist_location, hash_input, hash_algorithm):
    ascii_banner = pyfiglet.figlet_format(f"Oona's\nHASH CRACKER for {hash_algorithm}")
    print(ascii_banner)

    try:
        with open(wordlist_location, 'r') as file:
            for line in file:
                line = line.strip()
                if hash_algorithm == 'MD5':
                    hash_ob = hashlib.md5(line.encode()).hexdigest()
                elif hash_algorithm == 'SHA256':
                    hash_ob = hashlib.sha256(line.encode()).hexdigest()
                elif hash_algorithm == 'SHA512':
                    hash_ob = hashlib.sha512(line.encode()).hexdigest()
                else:
                    print("Can't recognize hash algorithm. Only MD5, SHA256, and SHA512 are supported.")
                    return

                if hash_ob == hash_input:
                    print('Found cleartext password:', line)
                    return
            print('Password not found in the wordlist. Try a different wordlist maybe?')
    except FileNotFoundError:
        print("Error: Wordlist file not found.")


if __name__ == "__main__":
    if len(sys.argv) != 4:
        print("Usage: python3 hash_cracker.py <wordlist_file> <hash_to_crack> <hash_algorithm> \n OR python hash_cracker.py <wordlist_file> <hash_to_crack> <hash_algorithm>")
        sys.exit(1)

    wordlist_location = sys.argv[1]
    hash_input = sys.argv[2]
    hash_algorithm = sys.argv[3].upper()
    crack_hash(wordlist_location, hash_input, hash_algorithm)
