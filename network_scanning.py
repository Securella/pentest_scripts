# Modified base from tryhackme.com
# source: https://tryhackme.com/room/pythonforcybersecurity
# + CodingNinja Blog 
# source: https://codingninjablogs.tech/tryhackme-python-for-pentesters-47b7ce525b90

import sys
from scapy.all import srp, Ether, ARP


def network_scanning(interface, ip_range):
    try:
        broadcast_mac = "ff:ff:ff:ff:ff:ff"
        packet = Ether(dst=broadcast_mac)/ARP(pdst=ip_range)
        ans, unans = srp(packet, timeout=2, iface=interface, inter=0.1)
        
        # Print out information about received packets
        print("Received packets:")
        for send, receive in ans:
            print(receive.summary())  # Print a summary of the received packet

        # Print out information about unanswered packets
        print("\nUnanswered packets:")
        for send, noanswer in unans:
            print(send.summary())  # Print a summary of the packet that was sent but got no response

        print("\nRemaining packets:", len(unans))
    except Exception as e:
        print(f"Error: {e}")


def main():
    if len(sys.argv) != 3:
        print("Usage: python3 network_scanning.py <interface> <ip_range>")
        sys.exit(1)

    interface = sys.argv[1]
    ip_range = sys.argv[2]

    network_scanning(interface, ip_range)


if __name__ == "__main__":
    main()
